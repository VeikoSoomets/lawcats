{% extends "base.html" %}
{% block title %}{% trans %}Dashboard{% endtrans %}{% endblock %}
{% block content %}

<div
  ng-app="dashboardApp"
  ng-controller="DashboardController as dc">
  <div class="row visible-xs-block"> <!-- latest results area on mobile -->
    <div class="col-xs-12">
      <h4>{% trans %}Latest Results{% endtrans %}</h4>
      <ul
        ng-show="dc.results.length && !dc.loadingResults"
        class="list-group">
        <li
          ng-repeat="result in dc.results"
          class="list-group-item">
          {% raw %}
          <span ng-bind="result.categories"></span>:
          <a href="{{result.result_link}}" target="_blank">
            <span ng-bind="result.result_title"></span>
          </a>
          {% endraw %}
        </li>
      </ul>

      <div
        ng-hide="dc.loadingResults || dc.results.length"
        class="alert alert-info"
        role="alert">
        {% trans %}No results{% endtrans %}.
      </div>

      <div class="progress progress-striped active" ng-show="dc.loadingResults">
        <div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
  
  <div class="row">
    <div class="col-xs-12">
      <h4>{% trans %}Overview{% endtrans %}</h4>
      <div class="progress progress-striped active" ng-show="dc.loadingCharts">
        <div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
        </div>
      </div>

      <canvas id="line-chart-elem">
        {% trans %}Your browser doesn't support the canvas tag.{% endtrans %}
      </canvas>

      <div
        ng-hide="dc.loadingCharts || dc.charts.pie"
        class="alert alert-info"
        role="alert">
        {% trans %}No results{% endtrans %}.
      </div>
    </div>
  </div>

  <div class="row">

    <div class="col-xs-12 col-md-4"> <!-- pie chart area -->
      <h4>{% trans %}Results distribution{% endtrans %}</h4>  
      <div class="progress progress-striped active" ng-show="dc.loadingCharts">
        <div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
        </div>
      </div>
      <canvas id="pie-chart-elem">
        {% trans %}Your browser doesn't support the canvas tag.{% endtrans %}
      </canvas>
      <div
        ng-hide="dc.loadingCharts || dc.charts.pie"
        class="alert alert-info"
        role="alert">
        {% trans %}No results{% endtrans %}.
      </div>
    </div>

    <div class="col-xs-12 col-md-4"> <!-- panels area -->
      
      <div class="row"> <!-- results panel -->
        <div class="col-xs-12">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="col-xs-3">
                <span class="glyphicon glyphicon-search dashboard-panel-icon"></span>
              </div>
              <div class="col-xs-9">
                <h4 class="dashboard-panel-heading">{{ new_results }} {% trans %}Search Results{% endtrans %}</h4>
                <a href="/app/results">{% trans %}See more{% endtrans %}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="row"> <!-- querywords panel -->
        <div class="col-xs-12">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="col-xs-3">
                <span class="glyphicon glyphicon-tasks dashboard-panel-icon"></span>
              </div>
              <div class="col-xs-9">
                <h4 class="dashboard-panel-heading">{{ qword_count }} {% trans %}Querywords{% endtrans %}</h4>
                <a href="/app/querywords">{% trans %}See more{% endtrans %}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="row"> <!-- Archived panel -->
        <div class="col-xs-12">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="col-xs-3">
                <span class="glyphicon glyphicon-folder-open dashboard-panel-icon"></span>
              </div>
              <div class="col-xs-9">
                <h4 class="dashboard-panel-heading">{{ old_results }} {% trans %}Archived results{% endtrans %}</h4>
                <a href="/app/results#archive">{% trans %}See more{% endtrans %}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <div class="col-xs-12 col-md-4">
      <h4>{% trans %}Latest Notifications{% endtrans %}</h4>  
      {% if user_events %}
        <ul class="list-group">
          {% for event in user_events %}
            <li class="list-group-item">
              <h5 class="list-group-item-heading">
                {{ event.event_count }} {{ event.event_name }}
              </h5>
              <p class="list-group-item-text">
                {{ event.minutes_ago }}
              </p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
      <p>{% trans %}No notifications.{% endtrans %}</p>
      {% endif %}
    </div>
  </div>

  <div class="row hidden-xs"> <!-- latest results area -->
    <div class="col-xs-12">
      <h4>{% trans %}Latest Results{% endtrans %}</h4>
      <ul
        ng-show="dc.results.length && !dc.loadingResults"
        class="list-group">
        <li
          ng-repeat="result in dc.results"
          class="list-group-item">
          {% raw %}
          <span ng-bind="result.categories"></span>:
          <a href="{{result.result_link}}" target="_blank">
            <span ng-bind="result.result_title"></span>
          </a>
          {% endraw %}
        </li>
      </ul>

      <div
        ng-hide="dc.loadingResults || dc.results.length"
        class="alert alert-info"
        role="alert">
        {% trans %}No results{% endtrans %}.
      </div>

      <div class="progress progress-striped active" ng-show="dc.loadingResults">
        <div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
{% block footer %}
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
<script type="text/javascript" src="/static/js/controllers/dashboard.js"></script>
{% endblock %}